#!/bin/bash

# begin in master branch

# Check if commit message input
if [ -z "$1" ]
then
  echo "What changes did you make? Type a commit message."
  exit 1
fi

# delete old site
rm -rf *
git add -A && git commit -m "delete old site"

# switch to hakyll branch and rebuild website
git checkout hakyll
stack build
stack exec blog rebuild

# switch to master, extract site and push
git checkout master
mv _site/* .
git add -A && git commit --amend -m "$1"
git push origin master

