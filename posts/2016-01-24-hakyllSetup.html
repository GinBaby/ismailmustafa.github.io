<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <!-- 
      loads the http over https ssl - 
      welcome to my website! 

	this theme is based off the Ice & Fire theme created by Lucas Gatsas
      https://www.twitter.com/LucasGatsas
      www.lucasgatsas.ch - switzerland. 
                                                    --> 

<!--
<script type="text/javascript">
var host = "https://katychuang.me/";
if ((host == window.location.host) && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script>
-->
<!-- Microsoft Internet Explorer documentMode compatMode setting IE Modus --> 
<script type="text/javascript">
var IE = null;
if (window.navigator.appName == "Microsoft Internet Explorer") {
  if (document.documentMode) {
  
    IE = document.documentMode; 
    } else {
   
        IE = 5; 
          if (document.compatMode) {
      if (document.compatMode == "CSS1Compat")
      IE = 11; 
      }
    }
  }
</script>

    <meta charset="utf-8">
    <!-- X-UA --> 
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <link rel="author" title="Katy Chuang" href="https://plus.google.com/u/0/111391719267336703432/posts" />


    <meta name="google" content="notranslate" />
    <!-- Viewport --> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- index ROBOTS follow --> 
    <meta name="robots" content="index, follow" />
    <!-- Site Desciption --> 
    <meta name="description" content="Mustafa's Musings">
        <!-- Site Desciption --> 
    <meta name="keywords" content="Ismail Mustafa, ijmustafa, ismailmustafa, Software Engineer, iOS Developer, iOS Engineer, iOS">
    <!-- Favicon --> 
    <link rel="shortcut icon" href="http://ismailmustafa.com/static/img/ico.png" type="image/x-icon" />
    <!-- Blog Title -->
    <title>Mustafa's Musings</title>

    <!--     <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
--> 
    <!-- Property Metas --> 
    <meta property="og:image" content="http://ismailmustafa.com/static/img/ix.png" />
    <meta property="og:title" content="Mustafa's Musings" />
    <meta property="og:site_name" content="Mustafa's Musings" />
    <!-- Canonical -->
    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
    <!-- StyleSheet -->
    <link rel="stylesheet" href="http://ismailmustafa.com/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://ismailmustafa.com/static/css/spaceg.stylesheets.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
	#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:url("/static/img/preloader.gif"); /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */}
	ul, ol {margin-top: 0;margin-bottom: 10px;}
	.navbar-inverse {background-color: #FFF;border-color: #FFFFFF;}
</style> 
<!--link rel="stylesheet" href="http://ismailmustafa.com/static/css/prettify.css"-->
<style>
	header.intro-header {background: #6f5499;background: no-repeat center center;background-attachment: scroll;-webkit-background-size: cover;-moz-background-size: cover;background-size: cover;-o-background-size: cover;}
	/* Preloader */#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:; /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */} 
	li {list-style: none;}
            body.modal-open 
            {overflow: hidden;padding-right: 0px;
        }
	article li {list-style: inherit;}
	article .figure {text-align: center}
    </style>
    <!-- end Loading front stylesheet here --> 
    </head>

    <body>
	<div id="preloader">
	    <div id="status">

	    </div>

	</div>  
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://ismailmustafa.com" id="blog-title-left-top">IM</a>
        </div>   
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#portfolioModal2" data-toggle="modal"><i class="fa fa-random" id="icon-top"></i></a>
                <ul class="dropdown-menu"></ul>
                </li>
                
                <li><a href="http://ismailmustafa.com/about.html" target="_self">About</a></li>
                <li><a href="http://ismailmustafa.com/contact.html" target="_self">Contact</a></li>
                <li><a href="http://ismailmustafa.com/projects.html" target="_self">Projects</a></li>
                <li><a href="http://ismailmustafa.com/archive.html" target="_self">Archive</a></li>
                <li><a href="https://www.github.com/ismailmustafa" id="roundbutton" target="_blank"><i class="fa fa-github"></i>ismailmustafa</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<!-- Portfolio Modals -->
    <div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h1 class="font-style-inline-small-h1">Ismail Mustafa</h1>
                            <hr class="star-primary">
                            <img src="http://ismailmustafa.com/static/img/face.jpg" class="img-responsive img-centered" alt title>
                            <p class="font-style-inline-small">
                                Hello, my name is Ismail Mustafa, I'm a Master's Student in Computer Science <br>
                                at NYU. Thanks for taking the time to visit my blog. I hope you like it! <br>
                                <a href="https://www.twitter.com/ijmustafa" target="_blank">follow me</a>. <br> 
                                <a href="https://www.github.com/ismailmustafa" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a> 
                                <a href="https://www.twitter.com/ijmustafa" target="_blank"><i class="fa fa-twitter" id="spaceg-social-modal"></i> </a>    
                                <a href="https://linkedin.com/in/ijmustafa" target="_blank"> <i class="fa fa-linkedin" id="spaceg-social-modal"></i></a> 
                            </p>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Menu Modals Add New Sa.21.Feb.2015 03:22:25 -->
    <div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h1 class="font-style-inline-small-h1">i.m</h1>
                            <hr class="star-primary">
                            <p class="font-style-inline-small">
                        <a href="https://www.twitter.com/ijmustafa" target="_blank">follow</a>. <br> 
                        <a href="https://www.github.com/ismailmustafa" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a> 
                        <a href="https://www.twitter.com/ijmustafa" target="_blank"><i class="fa fa-twitter" id="spaceg-social-modal"></i> </a>    
                        <a href="https://linkedin.com/in/ijmustafa" target="_blank"> <i class="fa fa-linkedin" id="spaceg-social-modal"></i></a>  <br>
                    <li><a href="http://ismailmustafa.com/" target="_self">Home</a></li>
                    <li><a href="http://ismailmustafa.com/about.html" target="_self">About Me</a></li>
                    <li><a href="http://ismailmustafa.com/projects.html" target="_self">Projects</a></li>
                    <li><a href="http://ismailmustafa.com/archive.html" target="_self">Archive</a></li>
                            </p>
                      
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



        <div id="content">
            <!-- Post Header -->

<header class="intro-header" style="background-image: url('http://ismailmustafa.com/static/img/2016-01-24-hakyllSetup.png')" alt title>

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Hakyll on Github Pages using Stack</h1>
                    
                    <span class="meta">
		    
			January 24, 2016
		    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

			<p>If you’ve seen the dates on my previous posts, you’ll know that I’ve been delaying writing a post for quite a while. So, I decided to start the new year with a blog refresh using Hakyll. I’ve also made it my new years resolution to start writing more blog posts about the work I’ve been doing.</p>
<p>In this post, I’m going to talk about how I set up Hakyll on Github Pages using Stack. For this tutorial, I’m assuming you already have Stack setup. If not, then get it <a href="http://www.haskellstack.org" target="_blank">here</a>. While you don’t actually need Stack to setup Hakyll, you’ll need it for this tutorial since the commands I’ll be showing use Stack.</p>
<h2 id="getting-started">Getting Started</h2>
<p>First, create a repository on Github for your Github Pages site with the following name:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">&lt;your-name&gt;</span>.github.io</code></pre></div>
<p>Be sure to create it without a README, and don’t clone it yet as we’ll push our hakyll repo up to it later.</p>
<p>Before I move on, I’ll explain exactly what we’ll be doing. First we’ll create a Hakyll project using the Stack Hakyll template. Then we’ll git init our directory and set it up so that we have two branches, a master branch and a hakyll branch where all our work will be done. The way github pages works is that it expects the index.html file to be in the top directory however when we build the site using hakyll, it generate the entire site in the _site/ subdirectory. Github pages won’t pick this up. So in this setup, the master branch will contain the generated website, and the Hakyll branch will contain all the code required to build it. Then we’ll create a script that will deploy the website for us without us having to switch back and forth between branches manually.</p>
<p>Back to the steps. We want to setup Hakyll using the Stack template for Hakyll:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">stack</span> new <span class="kw">&lt;</span>your-blog-name<span class="kw">&gt;</span> hakyll-template</code></pre></div>
<p>This will create a folder with the name <your-blog-name>. cd into this folder. You’ll notice that this template automatically generates a .gitignore file for you. If you’re on a mac, you’ll want to remember to add .DS_Store to your .gitignore (this should ideally be in your global gitignore).</p>
<h2 id="setting-your-blog-up-with-git">Setting your blog up with Git</h2>
<p>The next few commands will set up your Git repo so that there is a clear separation between your website on master, and the tools to generate your website on the hakyll branch. Git init the repo, and add your remote to your github pages repo:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">git</span> init
<span class="kw">git</span> add -A
<span class="kw">git</span> commit -m <span class="st">&quot;Initial commit&quot;</span>
<span class="kw">git</span> remote add origin git@github.com:<span class="kw">&lt;</span>github-name<span class="kw">&gt;</span>/<span class="kw">&lt;</span>github-name<span class="kw">&gt;</span>.github.io.git</code></pre></div>
<p>Then create a hakyll branch, and push it up to your blog:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">git</span> checkout -b hakyll
<span class="kw">git</span> push -u origin hakyll</code></pre></div>
<p>Now go back to your master branch, delete everything except for .git/ and .gitignore, and push that branch up as well.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">git</span> checkout master
<span class="kw">rm</span> -rf *
<span class="kw">rm</span> .ghci
<span class="kw">git</span> add -A
<span class="kw">git</span> commit -m <span class="st">&quot;Delete all files&quot;</span>
<span class="kw">git</span> push -u origin master</code></pre></div>
<p>We’ve now setup our repo correctly and all we have to do is go back to the hakyll (git checkout hakyll) branch and create our deploy script:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">touch</span> deploy
<span class="kw">chmod</span> 700 deploy</code></pre></div>
<p>And now open that file and copy the following into it:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">1</span>  <span class="co">#!/bin/bash</span>
<span class="kw">2</span>  shopt -s extglob
<span class="kw">3</span>
<span class="kw">4</span>  function error_exit
<span class="kw">5</span>  {
<span class="kw">6</span>      echo <span class="st">&quot;</span><span class="ot">$1</span><span class="st">&quot;</span> <span class="kw">1&gt;&amp;2</span>
<span class="kw">7</span>      exit 1
<span class="kw">8</span>  }
<span class="kw">9</span>
<span class="kw">10</span>  <span class="co"># Check if commit message argument</span>
<span class="kw">11</span>  if [ -z <span class="st">&quot;</span><span class="ot">$1</span><span class="st">&quot;</span> ]
<span class="kw">12</span>  then
<span class="kw">13</span>    echo <span class="st">&quot;deploy script error: What changes did you make? Type a commit message.&quot;</span>
<span class="kw">14</span>    exit 1
<span class="kw">15</span>  fi
<span class="kw">16</span>  
<span class="kw">17</span>  <span class="co"># Build successfuly or exit</span>
<span class="kw">18</span>  stack clean
<span class="kw">19</span>  stack build <span class="kw">||</span> <span class="kw">error</span>\_exit <span class="st">&quot;deploy script error: Build failed&quot;</span>
<span class="kw">20</span>  
<span class="kw">21</span>  <span class="co"># Push changes on hakyll branch to github</span>
<span class="kw">22</span>  git add -A
<span class="kw">23</span>  git commit -m <span class="st">&quot;</span><span class="ot">$1</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="kw">error</span>\_exit <span class="st">&quot;deploy script error: no changes to commit&quot;</span>
<span class="kw">24</span>  git push origin hakyll
<span class="kw">25</span>  
<span class="kw">26</span>  <span class="co"># Switch to master branch</span>
<span class="kw">27</span>  git checkout master
<span class="kw">28</span>  
<span class="kw">29</span>  <span class="co"># delete old site</span>
<span class="kw">30</span>  rm -rf !(CNAME) <span class="co"># dont delete CNAME</span>
<span class="kw">31</span>  git add -A <span class="kw">&amp;&amp;</span> <span class="kw">git</span> commit -m <span class="st">&quot;delete old site&quot;</span>
<span class="kw">32</span>  
<span class="kw">33</span>  <span class="co"># switch to hakyll branch and rebuild website</span>
<span class="kw">34</span>  git checkout hakyll
<span class="kw">35</span>  stack exec blog rebuild
<span class="kw">36</span>  
<span class="kw">37</span>  <span class="co"># switch to master, extract site and push</span>
<span class="kw">38</span>  git checkout master
<span class="kw">39</span>  mv \_site/<span class="dt">\*</span> .
<span class="kw">40</span>  git add -A <span class="kw">&amp;&amp;</span> <span class="kw">git</span> commit --amend -m <span class="st">&quot;</span><span class="ot">$1</span><span class="st">&quot;</span>
<span class="kw">41</span>  git push origin master
<span class="kw">42</span>  
<span class="kw">43</span>  <span class="co"># return to original branch</span>
<span class="kw">44</span>  git checkout hakyll</code></pre></div>
<p>I won’t go into too much detail because I feel as though I’ve commented it fairly well but I’ll give a quick summary. Lines 10 - 15 check if you’ve included a commit message as an argument to the script. It then checks if your project builds, in lines 17 - 19. Those changes are then commited and pushed to your hakyll branch. After switching back to the master branch, we delete the old website but ensure that the CNAME file isn’t deleted as we need that for custom domains. We then commit this with a generic message and switch back to the hakyll branch. We then invoke the hakyll rebuild command to build your website which creates the _site folder. Switching back to master brings this folder along. We then extract the contents of this folder, commit the changes, and push the new site up to origin.</p>
<h2 id="workflow">Workflow</h2>
<p>So now that we have our git repo set up with the proper branches, and a convenient deploy script that does all the work for us, what does this mean for our workflow? Well I now never have to leave the hakyll branch, and whenever I make any changes like writing a new blog post, all I have to do is type the following command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">./deploy</span> <span class="st">&quot;Wrote new blog post&quot;</span></code></pre></div>	

                <hr>

                <ul class="pager">
                    
                    
                </ul>







<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/

var getSegment = function (url, index) {
   return url.replace(/^https?:\/\//, '').split('/')[index];
}


var disqus_config = function () {
// Set url of page
this.page.url = document.URL; // Replace PAGE_URL with your page's canonical URL variable

// Determine ident of page
var lastPartOfLink = getSegment(document.URL,2);
var res = lastPartOfLink.split(".");
var ident = res[0];
this.page.identifier = ident; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//ismailmustafa-blog.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


            </div>

        </div>


    </div>





</article>
<hr>



        </div>
        <div id="footer">
        </div>
      <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        
                    
                    <li>
                        <a href="https://twitter.com/ijmustafa" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                     
                     
                    <li>
                        <a href="https://github.com/ismailmustafa" target="_blank">
                            <span class="fa-stack fa-lg">

                                <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                     
                    <li>
                        <a href="https://linkedin.com/in/ijmustafa" target="_blank">
                            <span class="fa-stack fa-lg">

                                <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-1x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
		    
                </ul>
                <p class="copyright text-muted">Copyright &copy; ismailmustafa 2016. <br><br> 
                </p>
<div class="col-md-12">
     <p class="copyright text-muted">
            Site generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>. Modified theme inspired by
      <!-- ICE AND FIRE THEME https://github.com/SpaceG/iceandfire -->
      <a href="https://github.com/SpaceG/CleanMagicMedium-Jekyll">CleanMagic</a>
        , and created by <a href="https://github.com/katychuang">Katy Chuang.</a> 
     </p>
    </div>


    
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="http://ismailmustafa.com/static/js/jquery.min.js"></script>
<script src="http://ismailmustafa.com/static/js/spaceg.stylesheets.min.js"></script> 
<script src="http://ismailmustafa.com/static/js/bootstrap.min.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<script src="http://ismailmustafa.com/static/js/scripts.js"></script>



    </body>
</html>
